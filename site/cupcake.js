class Objs{a=[];b=[null];insert(c){if(this.a.length>0){const d=this.a.pop();this.b[e]=c;return d;}else{this.b.push(c);return this.b.length-1;}}remove(f){if(f===this.b.length-1){this.b.pop();}else{this.b[f]=null;this.a.push(f);}}get(f){return this.b[f];}set(c,f){this.b[f]=c;}begin(){return 1;}end(){return this.b.length;}next(f){f++;while(f<this.b.length&&this.b[f]==null){f++;}return f;}};const g={h:new Objs(),i:new TextDecoder(),run(j,k){const l={};l.env={...m,...n,};fetch(j).then(o=>o.arrayBuffer()).then(p=>WebAssembly.instantiate(p,l)).then(q=>{m.setCanvasParent(k);const r=g.h.insert({c:q.instance.exports,s:true,});g.h.get(r).c.init(r);window.requestAnimationFrame(g.update);}).catch((t)=>console.log(t));},update(u){for(let v=g.h.begin();v<g.h.end();v=g.h.next(v)){if(g.h.get(v).s){g.h.get(v).c.update();}}window.requestAnimationFrame(g.update);},getSlice(w,x,y){return g.h.get(w).c.memory.buffer.slice(x,x+y);},getString(w,x,y){return g.i.decode(g.getSlice(w,x,y));},};function run(j,k){g.run(j,k);}const z=document.title;const m={A:new Objs(),k:document.body,B:new IntersectionObserver(function(C){C.forEach(D=>{for(let v=m.A.begin();v<m.A.end();v=m.A.next(v)){const E=m.A.get(v);if(E.c===D.target){g.h.get(E.w).s=D.isIntersecting;}}});}),logConsole(w,F,G){console.log(g.getString(w,F,G));},setWindowTitle(w,H,I){if(I>0){document.title=g.getString(w,H,I);}else{document.title=z;}},setCanvasParent(k){if(k===null){m.k=document.body;}else{m.k=document.getElementById(k);}},createCanvas(w,J,K){const E=document.createElement("canvas");E.width=J;E.height=K;m.k.appendChild(E);m.B.observe(E);return m.A.insert({c:E,w:w,L:m.k});},destroyCanvas(M){const E=m.A.get(M);E.L.removeChild(E.c);m.A.remove(M);},now(){return performance.now();},};const N=0;const O=1;const P=2;const Q=0;const R=0xFFFFFFFF;const S=0;const T=1;const U=2;const n={V:new Objs(),V:new Objs(),W:new Objs(),X:new Objs(),Y:new Objs(),Z:new Objs(),aa:new Objs(),ab:new Objs(),ac:new Objs(),ad:new Objs(),ae:new Objs(),af:new Objs(),ag:new Objs(),ah:new Objs(),ai:new Objs(),aj:new Objs(),createContext(M){return n.V.insert({c:m.A.get(M).c.getContext("webgpu"),ak:n.ae.insert({}),});},destroyContext(al){n.ae.remove(n.V.get(al).ak);n.V.remove(al);},getContextCurrentTexture(al){const am=n.V.get(al);n.ae.set({c:am.c.getCurrentTexture(),an:new Objs()},am.ak);return am.ak;},configure(w,ao,al,ap,aq,ar,J,K){const as={};as.device=n.X.get(ao);as.format=g.getString(w,ap,aq);as.usage=ar;as.size=[J,K];n.V.get(al).c.configure(as);},requestAdapter(w,at,au,av){navigator.gpu.requestAdapter(JSON.parse(g.getString(w,at,au))).then(aw=>{g.h.get(w).c.requestAdapterComplete(n.W.insert(aw),av);}).catch((t)=>{console.log(t);g.h.get(w).c.runtimeError(N);});},destroyAdapter(ax){n.W.remove(ax);},requestDevice(w,ax,at,au,av){const as=JSON.parse(g.getString(w,at,au));n.W.get(ax).requestDevice(as).then(ay=>{g.h.get(w).c.requestDeviceComplete(n.X.insert(ay),av);}).catch((t)=>{console.log(t);g.h.get(w).c.runtimeError(O);});},destroyDevice(ao){n.X.remove(ao);},createShader(w,ao,az,aA){const as={};as.code=g.getString(w,az,aA);return n.Y.insert(n.X.get(ao).createShaderModule(as));},destroyShader(aB){n.Y.remove(aB);},checkShaderCompile(w,aB){n.Y.get(aB).compilationInfo().then(aC=>{let t=false;for(let v=0;v<aC.messages.length;++v){const aD=aC.messages[v];console.log("line:",aD.lineNum,"col:",aD.linePos,aD.message);t|=aD.type=="error";}if(t){g.h.get(w).c.runtimeError(P);}});},createBindGroupLayout(w,ao,at,au){const as=JSON.parse(g.getString(w,at,au));return n.Z.insert(n.X.get(ao).createBindGroupLayout(as));},destroyBindGroupLayout(aE){n.Z.remove(aE);},createBindGroup(w,ao,aE,aF,aG,aH,aI,aJ,aK,aL,aM,at,au){const as=JSON.parse(g.getString(w,at,au));as.layout=n.Z.get(aE);const aN=new Uint32Array(g.getSlice(w,aF,aG));const aO=new Uint32Array(g.getSlice(w,aH,aI));const aP=new Uint32Array(g.getSlice(w,aJ,aK));const aQ=new Uint32Array(g.getSlice(w,aL,aM));for(let v=0;v<aN.length;++v){as.entries[v].resource={};switch(aN[v]){case S:as.entries[v].resource.buffer=n.ad.get(aO[v]);if(aP[v]!=0){as.entries[v].resource.offset=aP[v];}if(aQ[v]!=R){as.entries[v].resource.size=aQ[v];}break;case T:as.entries[v].resource.sampler=n.af.get(aO[v]);break;case U:as.entries[v].textureView=n.getTextureView(aO[v]);break;}}return n.aa.insert(n.X.get(ao).createBindGroup(as));},destroyBindGroup(aR){n.aa.remove(aR);},createPipelineLayout(w,ao,aS,aT){const aU=new Uint32Array(g.getSlice(w,aS,aT));const aV=[];for(let v=0;v<aU.length;++v){aV.push(n.Z.get(aU[v]));}const as={};as.bindGroupLayouts=aV;return n.ab.insert(n.X.get(ao).createPipelineLayout(as));},destroyPipelineLayout(aW){n.ab.remove(aW);},createRenderPipeline(w,ao,aW,aX,aY,at,au){const as=JSON.parse(g.getString(w,at,au));as.layout=n.ab.get(aW);as.vertex.module=n.Y.get(aX);if(aY!=Q){as.fragment.module=n.Y.get(aY);}return n.ac.insert(n.X.get(ao).createRenderPipeline(as));},destroyRenderPipeline(aZ){n.ac.remove(aZ);},createCommandEncoder(ao){return n.ag.insert(n.X.get(ao).createCommandEncoder());},finishCommandEncoder(ba){const bb=n.ah.insert(n.ag.get(ba).finish());n.ag.remove(ba);return bb;},beginRenderPass(w,ba,bc,bd,be,bf,bg,bh,bi,bj,at,au){const as=JSON.parse(g.getString(w,at,au));const bk=new Uint32Array(g.getSlice(w,bc,bd));for(let v=0;v<bk.length;++v){as.colorAttachments[v].view=n.getTextureView(bk[v]);}if(bf>0){const bl=new Uint32Array(g.getSlice(w,be,bf));for(let v=0;v<bl.length;++v){as.colorAttachments[v].resolveTarget=n.getTextureView(bl[v]);}}if(bg!=Q){as.depthStencilAttachment.view=n.getTextureView(bg);}if(bh!=Q){as.occlusionQuerySet=n.aj.get(bh);}if(bj>0){let bm=new Uint32Array(g.getSlice(w,bi,bj));for(let v=0;v<as.timestampWrites.length;++v){as.timestampWrites[v].querySet=n.aj.get(bm[v]);}}return n.ai.insert(n.ag.get(ba).beginRenderPass(as));},setPipeline(bn,bo){n.ai.get(bn).setPipeline(n.ac.get(bo));},setBindGroup(w,bn,bp,aR,bq,br){const bs=[];if(br>0){bs=new Uint32Array(g.getSlice(w,bq,br));}n.ai.get(bn).setBindGroup(bp,n.aa.get(aR),bs);},setVertexBuffer(bn,bt,bu,bv,bw){if((bw>>>0)===R){bw=undefined;}n.ai.get(bn).setVertexBuffer(bt,n.ad.get(bu),bv,bw);},setIndexBuffer(w,bn,bu,bx,by,bv,bw){if((bw>>>0)===R){bw=undefined;}n.ai.get(bn).setIndexBuffer(n.ad.get(bu),g.getString(w,bx,by),bv,bw);},draw(bn,bz,bA,bB,bC){n.ai.get(bn).draw(bz,bA,bB,bC);},drawIndexed(bn,bD,bA,bE,bF,bC){n.ai.get(bn).drawIndexed(bD,bA,bE,bF,bC);},endRenderPass(bn){n.ai.get(bn).endPass();n.ai.remove(bn);},queueSubmit(w,ao,bG,bH){const bI=new Uint32Array(g.getSlice(w,bG,bH));let bJ=[];for(let v=0;v<bI.length;++v){bJ.push(n.ah.get(bI[v]));}n.X.get(ao).queue.submit(bJ);bI.sort();for(let v=bI.length-1;v>=0;--v){n.ah.remove(bI[v]);}},queueWriteBuffer(w,ao,bu,bK,bL,bM,bN){n.X.get(ao).queue.writeBuffer(n.ad.get(bu),bK,new Uint8Array(g.getSlice(w,bL,bM)),bN,bM);},createBuffer(w,ao,bw,ar,bL,bM){const bO=bM>0;const as={};as.size=bw;as.usage=ar;as.mappedAtCreation=bO;const bP=n.X.get(ao).createBuffer(as);if(bO){const bQ=new Uint8Array(g.getSlice(w,bL,bM));const bR=new Uint8Array(bP.getMappedRange());bR.set(bQ);bP.unmap();}return n.ad.insert(bP);},destroyBuffer(bu){n.ad.get(bu).destroy();n.ad.remove(bu);},createTexture(w,ao,ar,bS,bT,J,K,bU,ap,aq,bV,bW,){const as={};as.usage=ar;as.dimension=g.getString(w,bS,bT);as.size={};as.size.width=J;as.size.height=K;as.size.depthOrArrayLayers=bU;as.format=g.getString(w,ap,aq);as.mipLevelCount=bV;as.sampleCount=bW;return n.ae.insert({c:n.X.get(ao).createTexture(as),an:new Objs()});},destroyTexture(bX){n.ae.remove(bX);},createTextureView(bX){const bY=n.ae.get(bX);return(bX<<16)|bY.an.insert(bY.c.createView());},destroyTextureView(bZ){n.ae.get(bZ>>>16).an.remove(bZ&0x0000FFFF);},getTextureView(bZ){return n.ae.get(bZ>>>16).an.get(bZ&0x0000FFFF);},};